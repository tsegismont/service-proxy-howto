<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Create a Vert.x Event Bus Service with Service Proxy | Eclipse Vert.x how-to</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
    crossorigin="anonymous">
  <link rel="icon" type="image/svg+xml" href="assets/images/vertx-square.svg">
</head>

<body>


<nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-purple mb-4 shadow-sm">
  <a class="navbar-brand" href="/">
    <img src="assets/images/vertx-square.svg" alt="Vert.x" width="40" height="40">
    &nbsp; Eclipse Vert.x how-to
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
    aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://vertx.io/docs/"><i class="fas fa-lg fa-drafting-compass"></i> Vert.x docs</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/vertx-howtos/service-proxy-howto"><i class="fab fa-lg fa-github"></i> Source
          code</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/vertx-howtos/service-proxy-howto/edit/master/README.adoc"><i
            class="far fa-lg fa-edit"></i>
          Edit this</a>
      </li>
    </ul>
  </div>
</nav>

<div class="container">

  <div class="row">
    <div class="col">
      <h1>Create a Vert.x Event Bus Service with Service Proxy</h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document will show you how to bootstrap an Event Bus service using Vert.x Service Proxy module. As you will see, this approach is particularly useful when you want to design and consume a service on the event bus using plain Java interfaces.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-you-will-build">What you will build</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will build a Vert.x application that exposes and uses <code>BarmanService</code>, an Event Bus Service that generates beers and manages customer bills.
We are going to deploy two verticles: the <code>BarmanVerticle</code> that exposes the service and the <code>DrunkVerticle</code> that consumes the service</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-you-need">What you need</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A text editor or IDE</p>
</li>
<li>
<p>Java 8 higher</p>
</li>
<li>
<p>Maven</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-a-project">Create a project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is the content of the <code>pom.xml</code> file you should be using:</p>
</div>
<div class="listingblock collapsed">
<div class="title">Maven <code>pom.xml</code></div>
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="xml"><span style="color: #999999;font-weight: bold">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span style="color: #000080">&lt;project</span> <span style="color: #008080">xmlns=</span><span style="color: #d14">"http://maven.apache.org/POM/4.0.0"</span>
         <span style="color: #008080">xmlns:xsi=</span><span style="color: #d14">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span style="color: #008080">xsi:schemaLocation=</span><span style="color: #d14">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style="color: #000080">&gt;</span>

  <span style="color: #000080">&lt;modelVersion&gt;</span>4.0.0<span style="color: #000080">&lt;/modelVersion&gt;</span>

  <span style="color: #000080">&lt;groupId&gt;</span>io.vertx.howtos<span style="color: #000080">&lt;/groupId&gt;</span>
  <span style="color: #000080">&lt;artifactId&gt;</span>service-proxy-howto<span style="color: #000080">&lt;/artifactId&gt;</span>
  <span style="color: #000080">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color: #000080">&lt;/version&gt;</span>

  <span style="color: #000080">&lt;properties&gt;</span>
    <span style="color: #000080">&lt;vertx.version&gt;</span>3.9.0<span style="color: #000080">&lt;/vertx.version&gt;</span>
    <span style="color: #000080">&lt;maven.compiler.source&gt;</span>1.8<span style="color: #000080">&lt;/maven.compiler.source&gt;</span>
    <span style="color: #000080">&lt;maven.compiler.target&gt;</span>1.8<span style="color: #000080">&lt;/maven.compiler.target&gt;</span>
  <span style="color: #000080">&lt;/properties&gt;</span>

  <span style="color: #000080">&lt;dependencyManagement&gt;</span>
    <span style="color: #000080">&lt;dependencies&gt;</span>
      <span style="color: #000080">&lt;dependency&gt;</span>
        <span style="color: #000080">&lt;groupId&gt;</span>io.vertx<span style="color: #000080">&lt;/groupId&gt;</span>
        <span style="color: #000080">&lt;artifactId&gt;</span>vertx-stack-depchain<span style="color: #000080">&lt;/artifactId&gt;</span>
        <span style="color: #000080">&lt;version&gt;</span>${vertx.version}<span style="color: #000080">&lt;/version&gt;</span>
        <span style="color: #000080">&lt;type&gt;</span>pom<span style="color: #000080">&lt;/type&gt;</span>
        <span style="color: #000080">&lt;scope&gt;</span>import<span style="color: #000080">&lt;/scope&gt;</span>
      <span style="color: #000080">&lt;/dependency&gt;</span>
    <span style="color: #000080">&lt;/dependencies&gt;</span>
  <span style="color: #000080">&lt;/dependencyManagement&gt;</span>

  <span style="color: #000080">&lt;dependencies&gt;</span>
    <span style="color: #000080">&lt;dependency&gt;</span>
      <span style="color: #000080">&lt;groupId&gt;</span>io.vertx<span style="color: #000080">&lt;/groupId&gt;</span>
      <span style="color: #000080">&lt;artifactId&gt;</span>vertx-codegen<span style="color: #000080">&lt;/artifactId&gt;</span>
      <span style="color: #000080">&lt;classifier&gt;</span>processor<span style="color: #000080">&lt;/classifier&gt;</span>
    <span style="color: #000080">&lt;/dependency&gt;</span>
    <span style="color: #000080">&lt;dependency&gt;</span>
      <span style="color: #000080">&lt;groupId&gt;</span>io.vertx<span style="color: #000080">&lt;/groupId&gt;</span>
      <span style="color: #000080">&lt;artifactId&gt;</span>vertx-service-proxy<span style="color: #000080">&lt;/artifactId&gt;</span>
    <span style="color: #000080">&lt;/dependency&gt;</span>
    <span style="color: #000080">&lt;dependency&gt;</span>
      <span style="color: #000080">&lt;groupId&gt;</span>io.vertx<span style="color: #000080">&lt;/groupId&gt;</span>
      <span style="color: #000080">&lt;artifactId&gt;</span>vertx-web-client<span style="color: #000080">&lt;/artifactId&gt;</span>
    <span style="color: #000080">&lt;/dependency&gt;</span>
  <span style="color: #000080">&lt;/dependencies&gt;</span>

  <span style="color: #000080">&lt;build&gt;</span>
    <span style="color: #000080">&lt;plugins&gt;</span>
      <span style="color: #000080">&lt;plugin&gt;</span>
        <span style="color: #000080">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color: #000080">&lt;/groupId&gt;</span>
        <span style="color: #000080">&lt;artifactId&gt;</span>exec-maven-plugin<span style="color: #000080">&lt;/artifactId&gt;</span>
        <span style="color: #000080">&lt;version&gt;</span>1.5.0<span style="color: #000080">&lt;/version&gt;</span>
        <span style="color: #000080">&lt;configuration&gt;</span>
          <span style="color: #000080">&lt;mainClass&gt;</span>io.vertx.howtos.ebservice.BeersApplication<span style="color: #000080">&lt;/mainClass&gt;</span>
        <span style="color: #000080">&lt;/configuration&gt;</span>
      <span style="color: #000080">&lt;/plugin&gt;</span>
    <span style="color: #000080">&lt;/plugins&gt;</span>
  <span style="color: #000080">&lt;/build&gt;</span>

<span style="color: #000080">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You must import both <code>vertx-codegen</code> with <code>processor</code> classifier and <code>vertx-service-proxy</code>. We are going to use <code>vertx-web-client</code> to load the beer names.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="design-the-barmanservice">Design the <code>BarmanService</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we must define our service interface. Under the hood, a code generator analyze it and generates the event bus message handler and the proxy class.</p>
</div>
<div class="paragraph">
<p>This is the <code>BarmanService</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #000000;font-weight: bold">package</span> <span style="color: #555555">io.vertx.howtos.ebservice.beers</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.codegen.annotations.ProxyGen</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.codegen.annotations.VertxGen</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.core.AsyncResult</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.core.Handler</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.core.Vertx</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #3c5d5d;font-weight: bold">@VertxGen</span>
<span style="color: #3c5d5d;font-weight: bold">@ProxyGen</span> // <b class="conum">(1)</b>
<span style="color: #000000;font-weight: bold">public</span> <span style="color: #000000;font-weight: bold">interface</span> <span style="color: #445588;font-weight: bold">BarmanService</span> <span style="color: #000000;font-weight: bold">{</span>

  <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">giveMeARandomBeer</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">String</span> <span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #445588;font-weight: bold">Handler</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">AsyncResult</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">Beer</span><span style="color: #000000;font-weight: bold">&gt;&gt;</span> <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(2)</b>

  <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">getMyBill</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">String</span> <span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #445588;font-weight: bold">Handler</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">AsyncResult</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">Integer</span><span style="color: #000000;font-weight: bold">&gt;&gt;</span> <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(3)</b>

  <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">payMyBill</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">String</span> <span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(4)</b>

  <span style="color: #000000;font-weight: bold">static</span> <span style="color: #445588;font-weight: bold">BarmanService</span> <span style="color: #990000;font-weight: bold">createProxy</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">Vertx</span> <span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #445588;font-weight: bold">String</span> <span style="background-color: #f8f8f8">address</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">{</span> // <b class="conum">(5)</b>
    <span style="color: #000000;font-weight: bold">return</span> <span style="color: #000000;font-weight: bold">new</span> <span style="color: #990000;font-weight: bold">BarmanServiceVertxEBProxy</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">address</span><span style="color: #000000;font-weight: bold">);</span>
  <span style="color: #000000;font-weight: bold">}</span>

<span style="color: #000000;font-weight: bold">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Add <code>@VertxGen</code> and <code>@ProxyGen</code> to trigger code generation</p>
</li>
<li>
<p>Define the method that generates a new beer and adds it to the bill of the customer specified. When the beer is ready, It calls the <code>handler</code> with the new beer</p>
</li>
<li>
<p>Define the method that retrieves the bill.</p>
</li>
<li>
<p>Define the method that settles the bill. This is a fire and forget method</p>
</li>
<li>
<p>Specify the method that creates a new proxy. <code>BarmanServiceVertxEBProxy</code> is the class name of the proxy that the code generator will create for us</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are a couple of rules you must follow while defining the service interface. Look at <a href="http://vertx.io/docs/vertx-service-proxy/java/#_restrictions_for_service_interface">Restrictions for service interface</a> for more info.
In our interface we are using a couple of primitives and <code>Beer</code>, a POJO annotated as <code>@DataObject</code>.
If you want to use <code>@DataObject`s inside your interface, they must define both a constructor with only a `JsonObject</code> parameter and a <code>toJson()</code> method that returns a <code>JsonObject</code></p>
</div>
<div class="paragraph">
<p>To trigger the code generation, you must also add in the same package of the interface a <code>package-info.java</code> with <code>@ModuleGen</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #3c5d5d;font-weight: bold">@ModuleGen</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">groupPackage</span> <span style="color: #000000;font-weight: bold">=</span> <span style="color: #d14">"io.vertx.howtos.ebservice"</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">name</span> <span style="color: #000000;font-weight: bold">=</span> <span style="color: #d14">"beers"</span><span style="color: #000000;font-weight: bold">)</span>
<span style="color: #000000;font-weight: bold">package</span> <span style="color: #555555">io.vertx.howtos.ebservice.beers</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.codegen.annotations.ModuleGen</span><span style="color: #000000;font-weight: bold">;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implement-the-barmanservice">Implement the <code>BarmanService</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you can implement the <code>BarmanService</code>.</p>
</div>
<div class="paragraph">
<p>For <code>giveMeARandomBeer()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #3c5d5d;font-weight: bold">@Override</span>
<span style="color: #000000;font-weight: bold">public</span> <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">giveMeARandomBeer</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">String</span> <span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #445588;font-weight: bold">Handler</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">AsyncResult</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">Beer</span><span style="color: #000000;font-weight: bold">&gt;&gt;</span> <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">{</span>
  <span style="background-color: #f8f8f8">webClient</span>
    <span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">get</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #009999">443</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #d14">"www.craftbeernamegenerator.com"</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #d14">"/api/api.php?type=classic"</span><span style="color: #000000;font-weight: bold">)</span>
    <span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">ssl</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #000000;font-weight: bold">true</span><span style="color: #000000;font-weight: bold">)</span>
    <span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">send</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">ar</span> <span style="color: #000000;font-weight: bold">-&gt;</span> <span style="color: #000000;font-weight: bold">{</span> // <b class="conum">(1)</b>
      <span style="color: #000000;font-weight: bold">if</span> <span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">ar</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">failed</span><span style="color: #000000;font-weight: bold">())</span> <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">handle</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">Future</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">failedFuture</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">ar</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">cause</span><span style="color: #000000;font-weight: bold">()));</span> // <b class="conum">(2)</b>
      <span style="color: #000000;font-weight: bold">else</span> <span style="color: #000000;font-weight: bold">{</span>
        <span style="color: #445588;font-weight: bold">JsonObject</span> <span style="background-color: #f8f8f8">result</span> <span style="color: #000000;font-weight: bold">=</span> <span style="background-color: #f8f8f8">ar</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">result</span><span style="color: #000000;font-weight: bold">().</span><span style="color: #008080">bodyAsJsonObject</span><span style="color: #000000;font-weight: bold">();</span>
        <span style="color: #000000;font-weight: bold">if</span> <span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">result</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">getInteger</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"status"</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">!=</span> <span style="color: #009999">200</span><span style="color: #000000;font-weight: bold">)</span> // <b class="conum">(2)</b>
          <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">handle</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">Future</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">failedFuture</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"Beer Generator Service replied with "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">result</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">getInteger</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"status"</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">+</span> <span style="color: #d14">": "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">result</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">getString</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"status_message"</span><span style="color: #000000;font-weight: bold">)));</span>
        <span style="color: #000000;font-weight: bold">else</span> <span style="color: #000000;font-weight: bold">{</span>
          <span style="color: #445588;font-weight: bold">Beer</span> <span style="background-color: #f8f8f8">beer</span> <span style="color: #000000;font-weight: bold">=</span> <span style="color: #000000;font-weight: bold">new</span> <span style="color: #445588;font-weight: bold">Beer</span><span style="color: #000000;font-weight: bold">(</span> // <b class="conum">(3)</b>
            <span style="background-color: #f8f8f8">result</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">getJsonObject</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"data"</span><span style="color: #000000;font-weight: bold">).</span><span style="color: #008080">getString</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"name"</span><span style="color: #000000;font-weight: bold">),</span>
            <span style="background-color: #f8f8f8">result</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">getJsonObject</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"data"</span><span style="color: #000000;font-weight: bold">).</span><span style="color: #008080">getString</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"style"</span><span style="color: #000000;font-weight: bold">),</span>
            <span style="color: #009999">3</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">random</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">nextInt</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #009999">5</span><span style="color: #000000;font-weight: bold">)</span>
          <span style="color: #000000;font-weight: bold">);</span>
          <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">out</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"Generated a new Beer! "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">beer</span><span style="color: #000000;font-weight: bold">);</span>
          <span style="background-color: #f8f8f8">bills</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">merge</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">beer</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">getPrice</span><span style="color: #000000;font-weight: bold">(),</span> <span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">oldVal</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">newVal</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">-&gt;</span> <span style="background-color: #f8f8f8">oldVal</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">newVal</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(4)</b>
          <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">handle</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">Future</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">succeededFuture</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">beer</span><span style="color: #000000;font-weight: bold">));</span> // <b class="conum">(5)</b>
        <span style="color: #000000;font-weight: bold">}</span>
      <span style="color: #000000;font-weight: bold">}</span>
    <span style="color: #000000;font-weight: bold">});</span>
<span style="color: #000000;font-weight: bold">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Send a request to the <a href="https://www.craftbeernamegenerator.com">Craft Beer Name Generator Service</a></p>
</li>
<li>
<p>Fail the async method if the request to external service failed</p>
</li>
<li>
<p>Create a new <code>Beer</code></p>
</li>
<li>
<p>Add the beer to the customer bill</p>
</li>
<li>
<p>Complete the async method with the generated beer</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For <code>getMyBill()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #3c5d5d;font-weight: bold">@Override</span>
<span style="color: #000000;font-weight: bold">public</span> <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">getMyBill</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">String</span> <span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #445588;font-weight: bold">Handler</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">AsyncResult</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">Integer</span><span style="color: #000000;font-weight: bold">&gt;&gt;</span> <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">{</span>
  <span style="background-color: #f8f8f8">handler</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">handle</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">Future</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">succeededFuture</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">bills</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">get</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">)));</span>
<span style="color: #000000;font-weight: bold">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code>settleMyBill()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #3c5d5d;font-weight: bold">@Override</span>
<span style="color: #000000;font-weight: bold">public</span> <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">payMyBill</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">String</span> <span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">{</span>
  <span style="background-color: #f8f8f8">bills</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">remove</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">);</span>
  <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">out</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"Removed debt of "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">customerName</span><span style="color: #000000;font-weight: bold">);</span>
<span style="color: #000000;font-weight: bold">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="expose-the-service">Expose the service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we can expose the service inside the <code>BarmanVerticle</code> with the <code>ServiceBinder</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #000000;font-weight: bold">package</span> <span style="color: #555555">io.vertx.howtos.ebservice</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.core.AbstractVerticle</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.ext.web.client.WebClient</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.howtos.ebservice.beers.BarmanService</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.howtos.ebservice.beers.impl.BarmanServiceImpl</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.serviceproxy.ServiceBinder</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">public</span> <span style="color: #000000;font-weight: bold">class</span> <span style="color: #445588;font-weight: bold">BarmanVerticle</span> <span style="color: #000000;font-weight: bold">extends</span> <span style="color: #445588;font-weight: bold">AbstractVerticle</span> <span style="color: #000000;font-weight: bold">{</span>

  <span style="color: #3c5d5d;font-weight: bold">@Override</span>
  <span style="color: #000000;font-weight: bold">public</span> <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">start</span><span style="color: #000000;font-weight: bold">()</span> <span style="color: #000000;font-weight: bold">{</span>
    <span style="color: #445588;font-weight: bold">BarmanService</span> <span style="background-color: #f8f8f8">service</span> <span style="color: #000000;font-weight: bold">=</span> <span style="color: #000000;font-weight: bold">new</span> <span style="color: #445588;font-weight: bold">BarmanServiceImpl</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">WebClient</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">create</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">));</span> // <b class="conum">(1)</b>

    <span style="color: #000000;font-weight: bold">new</span> <span style="color: #990000;font-weight: bold">ServiceBinder</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">)</span> // <b class="conum">(2)</b>
      <span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">setAddress</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"beers.services.myapplication"</span><span style="color: #000000;font-weight: bold">)</span> // <b class="conum">(3)</b>
      <span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">register</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">BarmanService</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">class</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">service</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(4)</b>
  <span style="color: #000000;font-weight: bold">}</span>
<span style="color: #000000;font-weight: bold">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Instantiate the <code>BarmanServiceImpl</code></p>
</li>
<li>
<p>Instantiate the <code>ServiceBinder</code></p>
</li>
<li>
<p>Configure the service address</p>
</li>
<li>
<p>Register the service on the event bus</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-the-service">Use the service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we can use the service with the generated proxy. For demo purposes I&#8217;m going to use it inside another verticle called <code>DrunkVerticle</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #000000;font-weight: bold">package</span> <span style="color: #555555">io.vertx.howtos.ebservice</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.core.AbstractVerticle</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.core.Future</span><span style="color: #000000;font-weight: bold">;</span>
<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.howtos.ebservice.beers.BarmanService</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">public</span> <span style="color: #000000;font-weight: bold">class</span> <span style="color: #445588;font-weight: bold">DrunkVerticle</span> <span style="color: #000000;font-weight: bold">extends</span> <span style="color: #445588;font-weight: bold">AbstractVerticle</span> <span style="color: #000000;font-weight: bold">{</span>

  <span style="color: #3c5d5d;font-weight: bold">@Override</span>
  <span style="color: #000000;font-weight: bold">public</span> <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">start</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">Future</span><span style="color: #000000;font-weight: bold">&lt;</span><span style="color: #445588;font-weight: bold">Void</span><span style="color: #000000;font-weight: bold">&gt;</span> <span style="background-color: #f8f8f8">startFuture</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">{</span>
    <span style="color: #445588;font-weight: bold">BarmanService</span> <span style="background-color: #f8f8f8">barmanService</span> <span style="color: #000000;font-weight: bold">=</span> <span style="color: #445588;font-weight: bold">BarmanService</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">createProxy</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">,</span> <span style="color: #d14">"beers.services.myapplication"</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(1)</b>

    <span style="background-color: #f8f8f8">barmanService</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">giveMeARandomBeer</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"homer"</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">b1</span> <span style="color: #000000;font-weight: bold">-&gt;</span> <span style="color: #000000;font-weight: bold">{</span> // <b class="conum">(2)</b>
      <span style="color: #000000;font-weight: bold">if</span> <span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">b1</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">failed</span><span style="color: #000000;font-weight: bold">())</span> <span style="color: #000000;font-weight: bold">{</span> // <b class="conum">(3)</b>
        <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">err</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"Cannot get my first beer!"</span><span style="color: #000000;font-weight: bold">);</span>
        <span style="background-color: #f8f8f8">startFuture</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">fail</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">b1</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">cause</span><span style="color: #000000;font-weight: bold">());</span>
        <span style="color: #000000;font-weight: bold">return</span><span style="color: #000000;font-weight: bold">;</span>
      <span style="color: #000000;font-weight: bold">}</span>
      <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">out</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"My first beer is a "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">b1</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">result</span><span style="color: #000000;font-weight: bold">()</span> <span style="color: #000000;font-weight: bold">+</span> <span style="color: #d14">" and it costs "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">b1</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">result</span><span style="color: #000000;font-weight: bold">().</span><span style="color: #008080">getPrice</span><span style="color: #000000;font-weight: bold">()</span> <span style="color: #000000;font-weight: bold">+</span> <span style="color: #d14">"€"</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(4)</b>
      <span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">setTimer</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #009999">1500</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">l</span> <span style="color: #000000;font-weight: bold">-&gt;</span>
        <span style="background-color: #f8f8f8">barmanService</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">giveMeARandomBeer</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"homer"</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">b2</span> <span style="color: #000000;font-weight: bold">-&gt;</span> <span style="color: #000000;font-weight: bold">{</span> // <b class="conum">(5)</b>
          <span style="color: #000000;font-weight: bold">if</span> <span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">b2</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">failed</span><span style="color: #000000;font-weight: bold">())</span> <span style="color: #000000;font-weight: bold">{</span>
            <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">out</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"Cannot get my second beer!"</span><span style="color: #000000;font-weight: bold">);</span>
            <span style="background-color: #f8f8f8">startFuture</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">fail</span><span style="color: #000000;font-weight: bold">(</span><span style="background-color: #f8f8f8">b2</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">cause</span><span style="color: #000000;font-weight: bold">());</span>
            <span style="color: #000000;font-weight: bold">return</span><span style="color: #000000;font-weight: bold">;</span>
          <span style="color: #000000;font-weight: bold">}</span>
          <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">out</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"My second beer is a "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">b2</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">result</span><span style="color: #000000;font-weight: bold">()</span> <span style="color: #000000;font-weight: bold">+</span> <span style="color: #d14">" and it costs "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">b2</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">result</span><span style="color: #000000;font-weight: bold">().</span><span style="color: #008080">getPrice</span><span style="color: #000000;font-weight: bold">()</span> <span style="color: #000000;font-weight: bold">+</span> <span style="color: #d14">"€"</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(6)</b>
          <span style="background-color: #f8f8f8">barmanService</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">getMyBill</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"homer"</span><span style="color: #000000;font-weight: bold">,</span> <span style="background-color: #f8f8f8">billAr</span> <span style="color: #000000;font-weight: bold">-&gt;</span> <span style="color: #000000;font-weight: bold">{</span>
            <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">out</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"My bill with the bar is "</span> <span style="color: #000000;font-weight: bold">+</span> <span style="background-color: #f8f8f8">billAr</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">result</span><span style="color: #000000;font-weight: bold">());</span> // <b class="conum">(7)</b>
            <span style="background-color: #f8f8f8">barmanService</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">payMyBill</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"homer"</span><span style="color: #000000;font-weight: bold">);</span> // <b class="conum">(8)</b>
            <span style="background-color: #f8f8f8">startFuture</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">complete</span><span style="color: #000000;font-weight: bold">();</span>
          <span style="color: #000000;font-weight: bold">});</span>
        <span style="color: #000000;font-weight: bold">})</span>
      <span style="color: #000000;font-weight: bold">);</span>
    <span style="color: #000000;font-weight: bold">});</span>

  <span style="color: #000000;font-weight: bold">}</span>
<span style="color: #000000;font-weight: bold">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Instantiate the proxy</p>
</li>
<li>
<p>Let&#8217;s try the first beer 🍺</p>
</li>
<li>
<p>Something went wrong during beer retrieval, fail the verticle start</p>
</li>
<li>
<p>Drinking the first one 🍻</p>
</li>
<li>
<p>Give me another one 🍺</p>
</li>
<li>
<p>Drinking the second one 🍻</p>
</li>
<li>
<p>Time to go home. Give me the bill</p>
</li>
<li>
<p>Pay the bill</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-application">Running the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run the application deploy the <code>BarmanVerticle</code> and subsequently the <code>DrunkVerticle</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight" style="background-color: #f8f8f8"><code data-lang="java"><span style="color: #000000;font-weight: bold">package</span> <span style="color: #555555">io.vertx.howtos.ebservice</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">import</span> <span style="color: #555555">io.vertx.core.Vertx</span><span style="color: #000000;font-weight: bold">;</span>

<span style="color: #000000;font-weight: bold">public</span> <span style="color: #000000;font-weight: bold">class</span> <span style="color: #445588;font-weight: bold">BeersApplication</span> <span style="color: #000000;font-weight: bold">{</span>

  <span style="color: #000000;font-weight: bold">public</span> <span style="color: #000000;font-weight: bold">static</span> <span style="color: #445588;font-weight: bold">void</span> <span style="color: #990000;font-weight: bold">main</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #445588;font-weight: bold">String</span><span style="color: #000000;font-weight: bold">[]</span> <span style="background-color: #f8f8f8">args</span><span style="color: #000000;font-weight: bold">)</span> <span style="color: #000000;font-weight: bold">{</span>
    <span style="color: #445588;font-weight: bold">Vertx</span> <span style="background-color: #f8f8f8">vertx</span> <span style="color: #000000;font-weight: bold">=</span> <span style="color: #445588;font-weight: bold">Vertx</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">vertx</span><span style="color: #000000;font-weight: bold">();</span>
    <span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">deployVerticle</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #000000;font-weight: bold">new</span> <span style="color: #445588;font-weight: bold">BarmanVerticle</span><span style="color: #000000;font-weight: bold">(),</span> <span style="background-color: #f8f8f8">ar</span> <span style="color: #000000;font-weight: bold">-&gt;</span> <span style="color: #000000;font-weight: bold">{</span>
      <span style="color: #445588;font-weight: bold">System</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">out</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">println</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #d14">"The barman is ready to serve you"</span><span style="color: #000000;font-weight: bold">);</span>
      <span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">deployVerticle</span><span style="color: #000000;font-weight: bold">(</span><span style="color: #000000;font-weight: bold">new</span> <span style="color: #445588;font-weight: bold">DrunkVerticle</span><span style="color: #000000;font-weight: bold">(),</span> <span style="background-color: #f8f8f8">ar2</span> <span style="color: #000000;font-weight: bold">-&gt;</span> <span style="color: #000000;font-weight: bold">{</span>
        <span style="background-color: #f8f8f8">vertx</span><span style="color: #000000;font-weight: bold">.</span><span style="color: #008080">close</span><span style="color: #000000;font-weight: bold">();</span>
      <span style="color: #000000;font-weight: bold">});</span>
    <span style="color: #000000;font-weight: bold">});</span>
  <span style="color: #000000;font-weight: bold">}</span>

<span style="color: #000000;font-weight: bold">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can run the application from:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>your IDE, by running the <code>main</code> method from the <code>BeersApplication</code> class, or</p>
</li>
<li>
<p>with Maven: <code>mvn compile exec:java</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should see something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The barman is ready to serve you
Generated a new Beer! Sourpuss (American Malt Liquor)
My first beer is a Sourpuss (American Malt Liquor) and it costs 5
Generated a new Beer! Amateur Mountain IPA (American IPA)
My second beer is a Amateur Mountain IPA (American IPA) and it costs 2
My bill with the bar is 7
Removed debt of homer</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This how-to explained to you:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>How to design and implement an Event Bus Service using Vert.x Service Proxy, and</p>
</li>
<li>
<p>How to expose the service on the event bus, and</p>
</li>
<li>
<p>How to use the service</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also">See also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="http://vertx.io/docs/vertx-service-proxy/java/">Vert.x Service Proxy Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <!-- Sharingbutton Facebook -->
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https://vertx-howtos.github.io/service-proxy-howto" target="_blank"
    rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small">
        <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z" />
                </svg>
        </div>
    </div>
</a>

<!-- Sharingbutton Twitter -->
<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Create%20a%20Vert.x%20Event%20Bus%20Service%20with%20Service%20Proxy&amp;url=https://vertx-howtos.github.io/service-proxy-howto"
    target="_blank" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
        <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z" />
                </svg>
        </div>
    </div>
</a>

<!-- Sharingbutton E-Mail -->
<a class="resp-sharing-button__link" href="mailto:?subject=Create%20a%20Vert.x%20Event%20Bus%20Service%20with%20Service%20Proxy&amp;body=https://vertx-howtos.github.io/service-proxy-howto" target="_self" rel="noopener"
    aria-label="">
    <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small">
        <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z" />
                </svg>
        </div>
    </div>
</a>

<!-- Sharingbutton LinkedIn -->
<a class="resp-sharing-button__link"
    href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://vertx-howtos.github.io/service-proxy-howto&amp;title=Create%20a%20Vert.x%20Event%20Bus%20Service%20with%20Service%20Proxy&amp;summary=Create%20a%20Vert.x%20Event%20Bus%20Service%20with%20Service%20Proxy&amp;source=https://vertx-howtos.github.io/service-proxy-howto"
    target="_blank" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small">
        <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z" />
                </svg>
        </div>
    </div>
</a>

<!-- Sharingbutton Reddit -->
<a class="resp-sharing-button__link"
    href="https://reddit.com/submit/?url=https://vertx-howtos.github.io/service-proxy-howto&amp;resubmit=true&amp;title=Create%20a%20Vert.x%20Event%20Bus%20Service%20with%20Service%20Proxy" target="_blank" rel="noopener"
    aria-label="">
    <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small">
        <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z" />
                </svg>
        </div>
    </div>
</a>

<!-- Sharingbutton WhatsApp -->
<a class="resp-sharing-button__link" href="whatsapp://send?text=Create%20a%20Vert.x%20Event%20Bus%20Service%20with%20Service%20Proxy%20https://vertx-howtos.github.io/service-proxy-howto" target="_blank" rel="noopener"
    aria-label="">
    <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small">
        <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z" />
                </svg>
        </div>
    </div>
</a>

<!-- Sharingbutton Telegram -->
<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Create%20a%20Vert.x%20Event%20Bus%20Service%20with%20Service%20Proxy&amp;url=https://vertx-howtos.github.io/service-proxy-howto"
    target="_blank" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small">
        <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z" />
                </svg>
        </div>
    </div>
</a>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <hr>
      <p><small>Last published: 2021-01-19 19:16:46 +0000.</small></p>
    </div>
  </div>
</div>

<script>
  (function () {
    const blocks = document.getElementsByClassName("collapsed");
    for (let i = 0; i < blocks.length; i++) {
      const block = blocks[i];
      const blockWrapper = document.createElement("div");
      const details = document.createElement("details");
      const summary = document.createElement("summary");
      summary.innerHTML = "Details <em>(click to expand)</em>";
      details.appendChild(summary);
      details.appendChild(blockWrapper);
      block.parentNode.insertBefore(details, block);
      blockWrapper.appendChild(block);
    }
  })();
</script>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
    crossorigin="anonymous"></script>
</body>

</html>